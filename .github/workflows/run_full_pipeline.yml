name: Rust LOC + COSMIC CFP Full Pipeline
on:
  workflow_dispatch:

jobs:
  full_pipeline:
    runs-on: ubuntu-latest

    steps:
      # --- Checkout repository ---
      - uses: actions/checkout@v4

      # --- Install system and Python dependencies ---
      - name: Install dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y python3 python3-pip git curl jq
          pip3 install matplotlib pandas numpy

      # --- Install Rust LOC analyzer (tokei) ---
      - name: Install tokei
        run: cargo install tokei

      # --- Prepare workspace ---
      - run: mkdir -p work

      # --- Fetch Top ~100 Rust repositories (Rust-major) ---
      - name: Fetch top Rust repositories (≥90% Rust, top 100 approx)
        run: |
          rm -f repos.txt
          for page in {1..2}; do  # each page ~50 repos → total ~100
            curl -s "https://api.github.com/search/repositories?q=language:Rust&sort=stars&order=desc&pag
